<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title data-i18n="hero_title">GAME SALE EXPO 2025 - The Biggest Game Sale Event</title>
  <meta name="description" content="Discover amazing deals on your favorite games at the Game Sale Expo 2025. Limited time offers and exclusive bundles available." />
  <meta name="generator" content="v0.dev" />
  <!-- Google Fonts: Inter -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet" />
  <!-- Tailwind CSS via CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- PapaParse 用於解析 CSV -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
  <style>
    /* 自定義 CSS 變數 (globals.css) */
    :root {
      --background: 0 0% 100%;
      --foreground: 0 0% 3.9%;
      --card: 0 0% 100%;
      --card-foreground: 0 0% 3.9%;
      --popover: 0 0% 100%;
      --popover-foreground: 0 0% 3.9%;
      --primary: 24 100% 50%;
      --primary-foreground: 0 0% 98%;
      --secondary: 0 0% 96.1%;
      --secondary-foreground: 0 0% 9%;
      --muted: 0 0% 96.1%;
      --muted-foreground: 0 0% 45.1%;
      --accent: 0 0% 96.1%;
      --accent-foreground: 0 0% 9%;
      --destructive: 0 84.2% 60.2%;
      --destructive-foreground: 0 0% 98%;
      --border: 0 0% 89.8%;
      --input: 0 0% 89.8%;
      --ring: 24 100% 50%;
      --radius: 0.5rem;
    }
    .dark {
      --background: 0 0% 3.9%;
      --foreground: 0 0% 98%;
      --card: 0 0% 3.9%;
      --card-foreground: 0 0% 98%;
      --popover: 0 0% 3.9%;
      --popover-foreground: 0 0% 98%;
      --primary: 24 100% 50%;
      --primary-foreground: 0 0% 98%;
      --secondary: 0 0% 14.9%;
      --secondary-foreground: 0 0% 98%;
      --muted: 0 0% 14.9%;
      --muted-foreground: 0 0% 63.9%;
      --accent: 0 0% 14.9%;
      --accent-foreground: 0 0% 98%;
      --destructive: 0 62.8% 30.6%;
      --destructive-foreground: 0 0% 98%;
      --border: 0 0% 14.9%;
      --input: 0 0% 14.9%;
      --ring: 24 100% 50%;
    }
    body {
      font-family: 'Inter', sans-serif;
      background-color: hsl(var(--background));
      color: hsl(var(--foreground));
    }
    .container {
      max-width: 80rem;
      margin-left: auto;
      margin-right: auto;
      padding-left: 1rem;
      padding-right: 1rem;
    }
    /* 遊戲卡片圖片放大效果 */
    .zoom-image {
      transition: transform 0.5s ease;
    }
    .zoom-image:hover {
      transform: scale(1.2);
    }
    /* 淡入動畫 */
    .fade-in {
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.6s ease-out, transform 0.6s ease-out;
    }
    .fade-in.visible {
      opacity: 1;
      transform: translateY(0);
    }
  </style>
</head>
<body>
  <div class="flex min-h-screen flex-col">
    <!-- Header -->
    <header class="sticky top-0 z-50 bg-black border-b border-orange-500">
      <div class="container flex h-16 items-center justify-between">
        <div class="flex items-center gap-2">
          <span data-i18n="logo_text" class="text-orange-500 font-bold text-xl">East Asia Indie Games Celebration</span>
        </div>
        <nav class="hidden md:flex items-center gap-6">
          <a href="/" data-i18n="home" class="text-white hover:text-orange-400 transition-colors">首頁</a>
          <a href="/#news-section" data-i18n="news" class="text-white hover:text-orange-400 transition-colors">NEWS</a>
          <a href="#deals-section" data-i18n="games" class="text-white hover:text-orange-400 transition-colors">GAMES</a>
          <a href="https://eaigc.filtergame.com/GameVote.html" data-i18n="Popularity" class="text-white hover:text-orange-400 transition-colors">Popularity poll + giveaway event</a>
          <a href="/#contact-section" data-i18n="contact" class="text-white hover:text-orange-400 transition-colors">CONTACT</a>
        </nav>
        <div class="flex items-center gap-4">
          <!-- 語言切換下拉選單 -->
          <select id="language-select" class="bg-black text-white text-sm border border-orange-500 rounded px-1">
            <option value="zh" data-i18n="language_zh">中文</option>
            <option value="en" data-i18n="language_en">EN</option>
            <option value="ja" data-i18n="language_ja">日本語</option>
			<option value="ko" data-i18n="language_ko">한국어</option>
			<option value="zh-Hans" data-i18n="language_zh_hans">简体中文</option>
          </select>
        </div>
      </div>
    </header>

    <!-- Main Content -->
    <main class="flex-1">
      <!-- Featured Deals 區 -->
      <section id="deals-section" class="py-12 bg-white">
        <div class="container">
          <div class="flex items-center justify-between mb-8">
            <h2 data-i18n="featured_deals" class="text-2xl font-bold">FEATURED DEALS</h2>
          </div>
          <div id="featured-deals-container" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
            <!-- 遊戲卡片由 JS 動態注入 -->
          </div>
        </div>
      </section>
    </main>

    <!-- Footer -->
    <footer class="bg-black text-white border-t border-orange-500">
      <div class="container py-8">
        <div class="flex flex-col md:flex-row justify-between items-center gap-4">
          <div class="flex items-center gap-2">
            <span data-i18n="logo_text" class="text-orange-500 font-bold">GAME SALE EXPO</span>
          </div>
          <div class="flex items-center gap-4">
            <a href="#" data-i18n="organizer" class="text-gray-400 ">舉辦單位:</a>
            <a href="https://leojuan1234.wordpress.com/" target="_blank" class="text-gray-400 hover:text-white transition-colors">焊蛙遊戲</a>
            <a href="https://linktr.ee/yohcanstudio" target="_blank" class="text-gray-400 hover:text-white transition-colors">葉開罐工作室</a>
            <a href="https://www.arcadegalaxy.space/" target="_blank" class="text-gray-400 hover:text-white transition-colors">第九商行</a>
            <a href="https://x.com/FilterGame_Dev/" target="_blank" class="text-gray-400 hover:text-white transition-colors">FilterGame</a>
          </div>
        </div>
        <div data-i18n="copyright" class="text-center text-gray-500 text-sm mt-8">© 2025 East Asia Indie Games Celebration. All rights reserved.</div>
      </div>
    </footer>
  </div>

  <!-- JavaScript：多國語系、Featured Deals 隨機顯示、淡入動畫 -->
  <script>
    const translations = {
      en: {
        logo_text: "East Asia Indie Games Celebration",
        home: "Home",
        news: "News",
        deals: "Deals",
        games: "Games",
        contact: "Contact",
        browse_deals: "Register Now",
        hero_title: "East Asia Indie Games Celebration 2025",
        hero_date: "August 5, 2025 - August 19, 2025",
        hero_description: "We sincerely invite independent game development teams from across East Asia (including Taiwan, China, Japan, Korea, Hong Kong, Macau, and other East Asian regions) to participate in this grand online game sale event and showcase our rich and diverse creative game culture.",
        featured_deals: "Games & Special Offers",
        news_section: "News",
        news_item: "East Asia Indie Games Celebration - Registration Open!",
        news_item2: "East Asia Indie Games Celebration - First Batch of Participants Announced",
        news_full_item_1: "We sincerely invite independent game development teams from across East Asia (including Taiwan, China, Japan, Korea, Hong Kong, Macau, and other East Asian regions) to participate in this grand online game sale event. Please submit your game details by April 4, 2025 (GMT+8) for initial approval.",
        news_full_item_2: "East Asia Indie Games Celebration - First Batch of Participants Announced!",
        news_full_item_3: "Full content of news item 3. (Sample text, please modify as needed.)",
        participating_publishers: "Participating Publishers",
        contact_us: "Contact Us",
        contact_description: "If you have any questions about the event, please contact our team for more information.",
        contact_button: "Contact Us",
        newsletter_title: "Game Sale Expo Newsletter",
        newsletter_description: "Subscribe to our newsletter to receive the latest offers and event updates.",
        subscribe: "Subscribe",
        privacy: "Privacy",
        terms: "Terms",
        about: "About",
        footer_contact: "Contact",
        language_en: "EN",
        language_zh: "中文",
        language_ja: "日本語",
        expand: "Expand",
        collapse: "Collapse",
        not_released: "Game Not Yet Released",
        demo_open: "Demo Version Available!",
        copyright: "© 2025 East Asia Indie Games Celebration. All rights reserved.",
		organizer: "Organizer:",
		Popularity : "Popularity poll + Giveaway event"

      },
      zh: {
        logo_text: "東亞獨立遊戲慶典",
        home: "首頁",
        news: "新聞",
        deals: "特賣",
        games: "全部遊戲",
        contact: "聯絡",
        browse_deals: "立即報名",
        hero_title: "東亞獨立遊戲慶典 2025",
        hero_date: "2025年8月5日至2025年8月19日",
        hero_description: "我們誠摯邀請來自東亞各地（包含台灣、中國、日本、韓國、香港、澳門及其他東亞區域）的獨立遊戲開發團隊，共同參與這場盛大的線上遊戲特賣會，展現我們豐富多元的創意遊戲文化。",
        featured_deals: "遊戲&特色優惠",
        news_section: "新聞",
        news_item: "東亞獨立遊戲慶典-報名開始!",
        news_item2: "東亞獨立遊戲慶典-公布第一批參展名單",
        news_full_item_1: "我們誠摯邀請來自東亞各地（包含台灣、中國、日本、韓國、香港、澳門及其他東亞區域）的獨立遊戲開發團隊，共同參與這場盛大的線上遊戲特賣會，展現我們豐富多元的創意遊戲文化。請於2025年4月4日前填寫遊戲資料。",
        news_full_item_2: "東亞獨立遊戲慶典-公布第一批參展名單!",
        news_full_item_3: "新聞項目 3 的完整內容。示例文本，請根據需求修改。",
        participating_publishers: "參與廠商",
        contact_us: "聯絡我們",
        contact_description: "對於遊戲特賣博覽有疑問？請聯絡我們的團隊獲得更多資訊。",
        contact_button: "聯絡我們",
        newsletter_title: "遊戲特賣博覽電子報",
        newsletter_description: "訂閱我們的電子報，獲得最新優惠和活動資訊。",
        subscribe: "訂閱",
        privacy: "隱私",
        terms: "條款",
        about: "關於",
        footer_contact: "聯絡",
        language_en: "EN",
        language_zh: "中文",
        language_ja: "日本語",
        expand: "展開",
        collapse: "收起",
        not_released: "遊戲尚未推出",
        demo_open: "試玩版開放中!",
        copyright: "© 2025 東亞獨立遊戲慶典。版權所有。",
		organizer: "舉辦單位:",
		Popularity : "人氣投票+抽獎活動"
      },
	  		"zh-Hans": {
		logo_text: "东亚独立游戏庆典",
		home: "首页",
		news: "新闻",
		deals: "特卖",
		games: "全部游戏",
		contact: "联络",
		browse_deals: "立即报名",
		hero_title: "东亚独立游戏庆典 2025",
		hero_date: "2025年8月5日至2025年8月19日",
		hero_description: "我们诚挚邀请来自东亚各地（包含台湾、中国、日本、韩国、香港、澳门及其他东亚区域）的独立游戏开发团队，共同参与这场盛大的线上游戏特卖会，展现我们丰富多元的创意游戏文化。",
		featured_deals: "游戏&特色优惠",
		news_section: "新闻",
		news_item: "东亚独立游戏庆典-报名开始!",
		news_item2: "东亚独立游戏庆典-公布参展名单",
		news_full_item_1: "我们诚挚邀请来自东亚各地（包含台湾、中国、日本、韩国、香港、澳门及其他东亚区域）的独立游戏开发团队，共同参与这场盛大的线上游戏特卖会，展现我们丰富多元的创意游戏文化。请于2025年4月4日前填写游戏资料。",
		news_full_item_2: "东亚独立游戏庆典-公布第一批参展名单!",
		news_full_item_3: "新闻项目 3 的完整内容。示例文本，请根据需求修改。",
		participating_publishers: "参与厂商",
		contact_us: "联络我们",
		contact_description: "对于游戏特卖博览有疑问？请联络我们的团队获得更多资讯。",
		contact_button: "联络我们",
		newsletter_title: "游戏特卖博览电子报",
		newsletter_description: "订阅我们的电子报，获得最新优惠和活动资讯。",
		subscribe: "订阅",
		privacy: "隐私",
		terms: "条款",
		about: "关于",
		footer_contact: "联络",
		language_en: "EN",
		language_zh: "中文",
		language_ja: "日本语",
		expand: "展开",
		collapse: "收起",
		not_released: "游戏尚未推出",
		demo_open: "试玩版开放中!",
		copyright: "© 2025 东亚独立游戏庆典。版权所有。",
		organizer: "举办单位:",
		discord_title: "一起玩吧！",
		discord_description : "不管你是玩家，还是开发者，或是主播...让我们一起玩吧!",
		Popularity : "人气投票+抽奖活动"
		},

      ja: {
        logo_text: "東亞インディーゲームセレブレーション",
        home: "ホーム",
        news: "ニュース",
        deals: "セール",
        games: "ゲーム",
        contact: "連絡先",
        browse_deals: "今すぐ申し込む",
        hero_title: "東亞インディーゲームセレブレーション 2025",
        hero_date: "2025年8月5日〜2025年8月19日",
        hero_description: "台湾、中国、日本、韓国、香港、マカオ、その他東亞地域のインディーゲーム開発チームの皆様を心よりご招待し、この盛大なオンラインゲームセールイベントで多彩なクリエイティブ文化を発信していただきます。",
        featured_deals: "ゲーム＆特別オファー",
        news_section: "ニュース",
        news_item: "東亞インディーゲームセレブレーション－募集開始！",
        news_item2: "東亞インディーゲームセレブレーション－第一陣の参加者発表",
        news_full_item_1: "台湾、中国、日本、韓国、香港、マカオ、その他東亞地域のインディーゲーム開発チームの皆様を心よりご招待いたします。2025年4月4日までにゲーム情報を提出してください。",
        news_full_item_2: "東亞インディーゲームセレブレーション－第一陣の参加者発表！",
        news_full_item_3: "ニュース項目3の完全な内容。（サンプルテキスト、必要に応じて修正してください。）",
        participating_publishers: "参加出版社",
        contact_us: "お問い合わせ",
        contact_description: "イベントに関するご質問は、ぜひ当チームまでお問い合わせください。",
        contact_button: "お問い合わせ",
        newsletter_title: "ゲームセールエキスポ ニュースレター",
        newsletter_description: "最新のオファーとイベント情報を受け取るために、ニュースレターにご登録ください。",
        subscribe: "購読",
        privacy: "プライバシー",
        terms: "利用規約",
        about: "概要",
        footer_contact: "お問い合わせ",
        language_en: "EN",
        language_zh: "中文",
        language_ja: "日本語",
        expand: "展開",
        collapse: "折りたたむ",
        not_released: "ゲーム未発売",
        demo_open: "体験版公開中！",
        copyright: "© 2025 東亞インディーゲームセレブレーション。全著作権所有。",
		organizer: "主催者:",
		Popularity : "人気投票＋抽選イベント"

      },
	    ko: {
        logo_text: "동아시아 인디 게임 축제",
        home: "홈",
        news: "뉴스",
        deals: "특가",
        games: "전체 게임",
        contact: "연락",
        browse_deals: "지금 등록하기",
        hero_title: "동아시아 인디 게임 축제 2025",
        hero_date: "2025년 8월 5일 ~ 2025년 8월 19일",
        hero_description: "대만, 중국, 일본, 한국, 홍콩, 마카오 및 기타 동아시아 지역의 인디 게임 개발팀을 진심으로 초대하여 이 거대한 온라인 게임 세일 행사에 참여하고, 풍부하고 다양한 창의적인 게임 문화를 선보입니다.",
        featured_deals: "게임 & 특별 혜택",
        news_section: "뉴스",
        news_item: "동아시아 인디 게임 축제 - 등록 시작!",
        news_item2: "동아시아 인디 게임 축제 - 1차 참가자 명단 공개",
        news_full_item_1: "대만, 중국, 일본, 한국, 홍콩, 마카오 및 기타 동아시아 지역의 인디 게임 개발팀을 진심으로 초대하여 이 거대한 온라인 게임 세일 행사에 참여하고, 풍부하고 다양한 창의적인 게임 문화를 선보입니다. 2025년 4월 4일 이전에 게임 정보를 작성해 주세요.",
        news_full_item_2: "동아시아 인디 게임 축제 - 1차 참가자 명단 공개!",
        news_full_item_3: "뉴스 항목 3의 전체 내용입니다. 샘플 텍스트이며 필요에 따라 수정해 주세요.",
        participating_publishers: "참여 퍼블리셔",
        contact_us: "문의하기",
        contact_description: "게임 세일 박람회에 대해 궁금하신 점이 있으시면 저희 팀에 문의해 주세요.",
        contact_button: "문의하기",
        newsletter_title: "게임 세일 박람회 뉴스레터",
        newsletter_description: "최신 혜택과 이벤트 정보를 받아보시려면 뉴스레터를 구독해 주세요.",
        subscribe: "구독",
        privacy: "개인정보",
        terms: "이용 약관",
        about: "소개",
        footer_contact: "연락",
        language_en: "EN",
        language_zh: "中文",
        language_ja: "日本語",
        language_ko: "한국어",
        expand: "펼치기",
        collapse: "접기",
        not_released: "게임 출시 전",
        demo_open: "체험판 공개 중!",
        copyright: "© 2025 동아시아 인디 게임 축제. 모든 권리 보유.",
		organizer: "주최:",
		Popularity : "인기 투표＋추첨 이벤트"

      }

    };

    let currentLanguage = "zh";
    let featuredDealsData = [];
    let currentShuffledDeals = [];
	const browserLang = navigator.language.toLowerCase();

	if (browserLang.startsWith("zh")) {
	  currentLanguage = browserLang === "zh-cn" || browserLang === "zh-hans" ? "zh-Hans" : "zh";
	} else if (browserLang.startsWith("ja")) {
	  currentLanguage = "ja";
	} else if (browserLang.startsWith("ko")) {
	  currentLanguage = "ko";
	} else if (browserLang.startsWith("en")) {
	  currentLanguage = "en";
	} else {
	  currentLanguage = "zh"; // fallback 預設為繁體中文
	}


    function updateTranslations() {
      document.querySelectorAll("[data-i18n]").forEach(el => {
        const key = el.getAttribute("data-i18n");
        const translated = translations[currentLanguage]?.[key];
        if (!translated) return;
        switch (el.tagName) {
          case "TITLE":
            document.title = translated;
            break;
          case "OPTION":
            el.text = translated;
            break;
          case "INPUT":
            el.placeholder = translated;
            break;
          default:
            el.textContent = translated;
            break;
        }
      });
    }

    function initFadeInAnimation() {
      const observer = new IntersectionObserver((entries, obs) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add("visible");
            obs.unobserve(entry.target);
          }
        });
      }, { threshold: 0.1 });
      document.querySelectorAll(".fade-in").forEach(el => observer.observe(el));
    }

    function shuffleArray(array) {
      const copy = array.slice();
      for (let i = copy.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [copy[i], copy[j]] = [copy[j], copy[i]];
      }
      return copy;
    }

    function renderShuffledDeals(data) {
      currentShuffledDeals = shuffleArray(data);
      renderDeals(currentShuffledDeals);
    }

    function renderDeals(data) {
      const container = document.getElementById("featured-deals-container");
      container.innerHTML = "";

      data.forEach(row => {
        const title = row["title_" + currentLanguage] || (currentLanguage === "zh-Hans" ? row["title_zh"] : row["title_en"]);
        const price = parseFloat(row.price);
        const tag = row.game_type;

        // 檢查 CSV 中的 bargain_price 欄位，若有填值（自訂圖片 URL）就用它，否則拼湊 Steam 圖片網址
        const customImageUrl = row.bargain_price && row.bargain_price.trim() !== ''
          ? row.bargain_price.trim()
          : null;
        const match = row.steamLink.match(/\/app\/(\d+)/);
        const defaultImageUrl = match
          ? `https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/${match[1]}/header.jpg`
          : `/placeholder.svg?height=300&width=400&text=${encodeURIComponent(title)}`;
        const imageUrl = customImageUrl || defaultImageUrl;

        const card = document.createElement("div");
        card.className = "border border-gray-200 rounded-lg overflow-hidden shadow-md hover:shadow-lg transition-shadow fade-in";

        const imgWrapper = document.createElement("div");
        imgWrapper.className = "relative h-48";
        const link = document.createElement("a");
		
		//新增UTM
		const rawLink = (row.steamLink || "").trim();
		if (rawLink === "") {
		  // 若沒有 steamLink，就不加連結
		  // 你可以改成 link.href = "#" 或乾脆跳過 append
		  link.removeAttribute("href");
		} else {
		  // 用 Steam 正式域名當 base
		  // 這樣即使 rawLink="/app/440/" 或以 "app/440" 開頭都 OK
		  const steamUrl = new URL(rawLink, "https://store.steampowered.com");
		  // 再加上 UTM
		  steamUrl.searchParams.set("utm_source", "eaigc2025");
		  link.href = steamUrl.toString();
		  link.target = "_blank";
		}
		
       // link.href = row.steamLink;
       // link.target = "_blank";
        const img = document.createElement("img");
        img.src = imageUrl;
        img.alt = title;
        img.className = "object-cover absolute inset-0 w-full h-full zoom-image";
        link.appendChild(img);
        imgWrapper.appendChild(link);

        card.appendChild(imgWrapper);

        const cardBody = document.createElement("div");
        cardBody.className = "p-4";
        const h3 = document.createElement("h3");
        h3.className = "font-bold mb-1";
        h3.textContent = title;
        cardBody.appendChild(h3);

        const infoDiv = document.createElement("div");
        if (price === -1) {
          infoDiv.className = "flex items-center justify-between mb-2";
          infoDiv.textContent = tag;
        }
        cardBody.appendChild(infoDiv);
        card.appendChild(cardBody);

        container.appendChild(card);
      });

      initFadeInAnimation();
    }

    function loadDealsCSV() {
      Papa.parse("deals.csv", {
        download: true,
        header: true,
        complete: function (results) {
          featuredDealsData = results.data;
          renderShuffledDeals(featuredDealsData); // 初次隨機排序顯示
        }
      });
    }

    document.addEventListener("DOMContentLoaded", () => {
      updateTranslations();
      loadDealsCSV();
      if (typeof loadPublishersCSV === "function") loadPublishersCSV();
    });

    document.getElementById("language-select").addEventListener("change", e => {
      currentLanguage = e.target.value;
      updateTranslations();
      if (currentShuffledDeals.length) renderDeals(currentShuffledDeals);
    });
  </script>
</body>
</html>
